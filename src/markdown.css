/* Unified Markdown styles for both Viewer and Editor */
/* All markdown-related styling consolidated here */

/* Base prose styling */
.markdown-content {
  @apply prose prose-gray dark:prose-invert max-w-none prose-lg;
}

/* Typography improvements */
.markdown-content {
  /* Headings - reduce margins significantly and add progressive indentation */
  @apply prose-headings:font-semibold prose-headings:text-gray-900 dark:prose-headings:text-gray-100;
  @apply prose-h1:text-3xl prose-h1:mb-3 prose-h1:mt-6 prose-h1:border-b prose-h1:border-gray-200 dark:prose-h1:border-gray-700 prose-h1:pb-2;
  @apply prose-h2:text-2xl prose-h2:mb-2 prose-h2:mt-4;
  @apply prose-h3:text-xl prose-h3:mb-1 prose-h3:mt-3;
  @apply prose-h4:text-lg prose-h4:mb-1 prose-h4:mt-2;
}

/* Progressive header indentation */
.markdown-content h1 {
  padding-left: 0; /* No indent for H1 */
}

.markdown-content h2 {
  padding-left: 0.75rem; /* Small indent for H2 */
}

.markdown-content h3 {
  padding-left: 1.5rem; /* Double the H2 indent for H3 */
}

.markdown-content h4 {
  padding-left: 2.25rem; /* Progressive indent for H4 */
}

.markdown-content h5 {
  padding-left: 3rem; /* Progressive indent for H5 */
}

.markdown-content h6 {
  padding-left: 3.75rem; /* Progressive indent for H6 */
}

/* Content indentation will be handled by JavaScript */

.markdown-content {
  /* Anchor links for headers */
  h1:hover .anchor-link,
  h2:hover .anchor-link,
  h3:hover .anchor-link,
  h4:hover .anchor-link,
  h5:hover .anchor-link,
  h6:hover .anchor-link {
    @apply opacity-100;
  }

  .anchor-link {
    @apply text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300;
    @apply no-underline opacity-0;
    @apply transition-opacity duration-200;
    @apply ml-2 text-sm;
  }

  /* Paragraphs - reduce line height and bottom margin */
  @apply prose-p:text-gray-600 dark:prose-p:text-gray-400 prose-p:leading-normal prose-p:mb-2;

  /* Lists - reduce spacing between items */
  @apply prose-ul:my-2 prose-ol:my-2;
  @apply prose-li:my-0 prose-li:leading-normal prose-li:mb-1;
  @apply prose-li:text-gray-600 dark:prose-li:text-gray-400;
}

/* Additional custom spacing overrides */
.markdown-content ul li {
  margin-bottom: 0.25rem; /* 25% more than paragraph spacing (0.2rem) */
  line-height: 1.4; /* Slightly tighter than normal */
}

.markdown-content ol li {
  margin-bottom: 0.25rem;
  line-height: 1.4;
}

.markdown-content p {
  line-height: 1.4; /* 50% less than relaxed (1.625) */
  margin-bottom: 0.75rem; /* Reduced paragraph spacing */
  margin-top: 0; /* Remove top margin */
}

/* Reduce space between headers and immediately following content */
.markdown-content h1 + p,
.markdown-content h2 + p,
.markdown-content h3 + p,
.markdown-content h4 + p,
.markdown-content h5 + p,
.markdown-content h6 + p {
  margin-top: 0.25rem; /* Very tight spacing after headers */
}

.markdown-content h1 + ul,
.markdown-content h2 + ul,
.markdown-content h3 + ul,
.markdown-content h4 + ul,
.markdown-content h5 + ul,
.markdown-content h6 + ul,
.markdown-content h1 + ol,
.markdown-content h2 + ol,
.markdown-content h3 + ol,
.markdown-content h4 + ol,
.markdown-content h5 + ol,
.markdown-content h6 + ol {
  margin-top: 0.25rem; /* Tight spacing between headers and lists */
}

.markdown-content {
  /* Links */
  @apply prose-a:text-primary-600 hover:prose-a:text-primary-700 dark:prose-a:text-primary-400 dark:hover:prose-a:text-primary-300;
  @apply prose-a:font-medium prose-a:no-underline hover:prose-a:underline;

  /* Strong text */
  @apply prose-strong:text-gray-900 dark:prose-strong:text-gray-100 prose-strong:font-semibold;

  /* Emphasis */
  @apply prose-em:text-gray-800 dark:prose-em:text-gray-200 prose-em:italic;

  /* Lists */
  @apply prose-li:text-gray-700 dark:prose-li:text-gray-300 prose-li:mb-1;
  @apply prose-ul:my-4 prose-ol:my-4;
  @apply prose-ul:pl-6 prose-ol:pl-6;
}

/* Code styling */
.markdown-content {
  /* Inline code */
  @apply prose-code:text-pink-600 dark:prose-code:text-pink-400;
  @apply prose-code:bg-gray-100 dark:prose-code:bg-gray-800;
  @apply prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:font-mono;
  @apply prose-code:before:content-none prose-code:after:content-none;

  /* Code blocks */
  @apply prose-pre:bg-gray-900 dark:prose-pre:bg-gray-800;
  @apply prose-pre:text-gray-100 prose-pre:rounded-lg prose-pre:p-4;
  @apply prose-pre:text-sm prose-pre:font-mono;
  @apply prose-pre:border prose-pre:border-gray-700 dark:prose-pre:border-gray-600;
}

/* Code within pre blocks */
.markdown-content pre {
  overflow-x: visible; /* Remove horizontal scroll */
  white-space: pre-wrap; /* Enable wrapping while preserving formatting */
}

.markdown-content pre code {
  @apply bg-transparent p-0 text-inherit;
  white-space: pre-wrap; /* Enable wrapping in code blocks */
  word-break: break-word; /* Break long words if necessary */
}

/* Blockquotes */
.markdown-content {
  @apply prose-blockquote:border-l-4 prose-blockquote:border-primary-500;
  @apply prose-blockquote:bg-gray-50 dark:prose-blockquote:bg-gray-800;
  @apply prose-blockquote:text-gray-700 dark:prose-blockquote:text-gray-300;
  @apply prose-blockquote:pl-6 prose-blockquote:py-3 prose-blockquote:my-6;
  @apply prose-blockquote:italic prose-blockquote:rounded-r-lg;
  @apply prose-blockquote:not-italic;
}

/* Tables */
.markdown-content {
  @apply prose-table:text-sm prose-table:border-collapse prose-table:w-full prose-table:my-6;
  @apply prose-th:bg-gray-50 dark:prose-th:bg-gray-800 prose-th:font-semibold prose-th:text-left;
  @apply prose-th:px-4 prose-th:py-3 prose-th:border prose-th:border-gray-200 dark:prose-th:border-gray-700;
  @apply prose-td:px-4 prose-td:py-3 prose-td:border prose-td:border-gray-200 dark:prose-td:border-gray-700;
  @apply prose-tr:hover:bg-gray-50 dark:prose-tr:hover:bg-gray-800;
}

/* Images */
.markdown-content {
  @apply prose-img:rounded-lg prose-img:shadow-md prose-img:my-6;
  @apply prose-img:border prose-img:border-gray-200 dark:prose-img:border-gray-700;
  @apply prose-img:max-w-full prose-img:h-auto;
}

/* Horizontal rules */
.markdown-content {
  @apply prose-hr:border-gray-300 dark:prose-hr:border-gray-600 prose-hr:my-8;
  @apply prose-hr:border-t-2;
}

/* Task lists (checkboxes) */
.markdown-content input[type='checkbox'] {
  @apply mr-2;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  border: 2px solid #6b7280; /* gray-500 */
  border-radius: 3px;
  background-color: transparent;
  position: relative;
  cursor: pointer;
}

/* Dark mode unchecked checkbox */
.dark .markdown-content input[type='checkbox'] {
  border-color: #9ca3af; /* gray-400 */
}

/* Checked checkboxes - green with checkmark */
.markdown-content input[type='checkbox']:checked {
  background-color: #16a34a; /* green-600 */
  border-color: #16a34a; /* green-600 */
}

/* Dark mode checked checkbox */
.dark .markdown-content input[type='checkbox']:checked {
  background-color: #22c55e; /* green-500 */
  border-color: #22c55e; /* green-500 */
}

/* Checkmark symbol */
.markdown-content input[type='checkbox']:checked::after {
  content: 'âœ“';
  position: absolute;
  top: -2px;
  left: 2px;
  font-size: 12px;
  font-weight: bold;
  color: white;
  line-height: 1;
}

.markdown-content li {
  @apply marker:text-gray-400 dark:marker:text-gray-500;
}

/* Task list items without bullets */
.markdown-content .contains-task-list {
  @apply list-none ml-0;
}

/* Custom scrollbar for markdown content */
.markdown-content::-webkit-scrollbar {
  width: 8px;
}

.markdown-content::-webkit-scrollbar-track {
  @apply bg-gray-100 dark:bg-gray-800;
}

.markdown-content::-webkit-scrollbar-thumb {
  @apply bg-gray-300 dark:bg-gray-600 rounded;
}

.markdown-content::-webkit-scrollbar-thumb:hover {
  @apply bg-gray-400 dark:bg-gray-500;
}

/* Simple Editor Styles - Clean textarea-based editor */
.simple-editor-container {
  height: 100%;
  width: 100%;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  font-size: 14px;
}

/* Markdown Syntax Highlighting CSS Classes */
/* These classes will be used by the syntax highlighting overlay system */

:root {
  /* Light theme colors - VS Code inspired */
  --md-header-color: #a31515;
  --md-header-marker-color: #a31515;
  --md-bold-color: #0000ff;
  --md-bold-marker-color: #808080;
  --md-italic-color: #008000;
  --md-italic-marker-color: #808080;
  --md-code-color: #a31515;
  --md-code-marker-color: #808080;
  --md-code-bg-color: #f6f8fa;
  --md-link-color: #0000ff;
  --md-link-text-color: #0000ff;
  --md-link-url-color: #808080;
  --md-image-color: #0000ff;
  --md-list-marker-color: #808080;
  --md-list-item-color: #000000;
  --md-blockquote-color: #808080;
  --md-blockquote-marker-color: #808080;
  --md-strikethrough-color: #808080;
  --md-strikethrough-marker-color: #808080;
  --md-hr-color: #808080;
  --md-table-color: #000000;
  --md-text-color: #000000;
}

.dark {
  /* Dark theme colors - VS Code inspired */
  --md-header-color: #569cd6;
  --md-header-marker-color: #569cd6;
  --md-bold-color: #d7ba7d;
  --md-bold-marker-color: #808080;
  --md-italic-color: #4ec9b0;
  --md-italic-marker-color: #808080;
  --md-code-color: #ce9178;
  --md-code-marker-color: #808080;
  --md-code-bg-color: #161b22;
  --md-link-color: #569cd6;
  --md-link-text-color: #569cd6;
  --md-link-url-color: #808080;
  --md-image-color: #569cd6;
  --md-list-marker-color: #808080;
  --md-list-item-color: #d4d4d4;
  --md-blockquote-color: #608b4e;
  --md-blockquote-marker-color: #808080;
  --md-strikethrough-color: #808080;
  --md-strikethrough-marker-color: #808080;
  --md-hr-color: #808080;
  --md-table-color: #d4d4d4;
  --md-text-color: #d4d4d4;
}

/* Syntax highlighting classes */
.md-header {
  color: var(--md-header-color);
  font-weight: bold;
}

.md-header-marker {
  color: var(--md-header-marker-color);
  font-weight: bold;
}

.md-bold {
  color: var(--md-bold-color);
  font-weight: bold;
}

.md-bold-marker {
  color: var(--md-bold-marker-color);
  font-weight: normal;
}

.md-italic {
  color: var(--md-italic-color);
  font-style: italic;
}

.md-italic-marker {
  color: var(--md-italic-marker-color);
  font-style: normal;
}

.md-code {
  color: var(--md-code-color);
  background-color: var(--md-code-bg-color);
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  font-size: 0.9em;
  padding: 0.1em 0.25em;
  border-radius: 3px;
}

.md-code-marker {
  color: var(--md-code-marker-color);
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
}

.md-link {
  color: var(--md-link-color);
}

.md-link-text {
  color: var(--md-link-text-color);
  text-decoration: underline;
}

.md-link-url {
  color: var(--md-link-url-color);
}

.md-image {
  color: var(--md-image-color);
}

.md-image-alt {
  color: var(--md-image-color);
  font-style: italic;
}

.md-image-url {
  color: var(--md-link-url-color);
}

.md-list-marker {
  color: var(--md-list-marker-color);
  font-weight: bold;
}

.md-list-item {
  color: var(--md-list-item-color);
}

.md-blockquote {
  color: var(--md-blockquote-color);
  font-style: italic;
}

.md-blockquote-marker {
  color: var(--md-blockquote-marker-color);
  font-weight: bold;
}

.md-strikethrough {
  color: var(--md-strikethrough-color);
  text-decoration: line-through;
}

.md-strikethrough-marker {
  color: var(--md-strikethrough-marker-color);
}

.md-hr {
  color: var(--md-hr-color);
  font-weight: bold;
}

.md-table {
  color: var(--md-table-color);
}

.md-text {
  color: var(--md-text-color);
}

/* Syntax Highlighted Editor - Mirror Div Approach */
.syntax-highlighted-editor {
  position: relative;
  height: 100%;
  width: 100%;
}

.syntax-highlight-backdrop {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  font-size: 14px;
  line-height: 1.5;
  padding: 16px;
  margin: 0;
  border: 0;
  outline: none;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow: auto;
  pointer-events: none;
  z-index: 1;
  background: transparent;
  color: var(--md-text-color);
}

.syntax-editor-textarea {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  font-size: 14px;
  line-height: 1.5;
  padding: 16px;
  margin: 0;
  border: 0;
  outline: none;
  resize: none;
  background: transparent;
  color: transparent;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow: auto;
  z-index: 2;
  caret-color: var(--md-text-color);
}

.syntax-editor-textarea::selection {
  background: #3178c6;
  color: white;
}

.dark .syntax-editor-textarea::selection {
  background: #264f78;
  color: white;
}

.syntax-editor-textarea::placeholder {
  color: #9ca3af;
  opacity: 1;
}

.dark .syntax-editor-textarea::placeholder {
  color: #6b7280;
}

/* Ensure backdrop and textarea have identical styling */
.syntax-highlight-backdrop,
.syntax-editor-textarea {
  font-variant-ligatures: none;
  font-feature-settings: normal;
  tab-size: 2;
  -webkit-text-size-adjust: none;
  text-size-adjust: none;
  /* Critical: Ensure identical text rendering and scrolling */
  word-break: normal;
  overflow-wrap: break-word;
  font-kerning: none;
  font-synthesis: none;
  scroll-behavior: auto;
  box-sizing: border-box;
  /* Ensure both scroll containers behave identically */
  scrollbar-width: thin;
  -ms-overflow-style: -ms-autohiding-scrollbar;
}

/* Background for the entire editor */
.syntax-highlighted-editor {
  background: white;
}

.dark .syntax-highlighted-editor {
  background: #0d1117;
}

/* Print styles */
@media print {
  .markdown-content {
    @apply text-black;
  }

  .markdown-content pre {
    @apply bg-gray-100 text-black border border-gray-300;
  }

  .markdown-content code {
    @apply bg-gray-100 text-black;
  }
}
